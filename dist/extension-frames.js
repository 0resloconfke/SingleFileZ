!function(){"use strict";const e="single-filez-response-fetch",t="text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",r=window.fetch;function a(t){return new Promise(((r,a)=>{var s,n,i,o;s=new CustomEvent("single-filez-request-fetch",{detail:t}),window.dispatchEvent(s),n=e,i=function s(n){var i,o,d;n.detail?n.detail.url==t&&(i=e,o=s,d=!1,window.removeEventListener(i,o,d),n.detail.response?r({status:n.detail.status,headers:new Map(n.detail.headers),arrayBuffer:async()=>n.detail.response}):a(n.detail.error)):a()},o=!1,window.addEventListener(n,i,o)}))}browser.runtime.onMessage.addListener((e=>{if("singlefile.fetchFrame"==e.method&&window.frameId&&window.frameId==e.frameId)return async function(e){try{let s=await r(e.url,{cache:"force-cache",headers:new Headers({accept:t})});return 401!=s.status&&403!=s.status&&404!=s.status||(s=await Promise.race([a(e.url),new Promise(((e,t)=>setTimeout((()=>t()),5e3)))])),{status:s.status,headers:[...s.headers],array:Array.from(new Uint8Array(await s.arrayBuffer()))}}catch(e){return{error:e&&e.toString()}}}(e)}))}();
